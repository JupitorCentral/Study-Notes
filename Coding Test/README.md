$1 <= |P| <= |S| <= 1,000,000$
